var getTableHeight=function(){return $("body").height()-$("#opt").outerHeight(true)-$("#query").outerHeight(true)-50};$("#mapview").height(getTableHeight());var interface=dataset;var tableData;var $table;$(function(){queryData()});function queryData(){queryTable()}function bootstrapTable(querycondition,dataset){var width=$("#listview").outerWidth()/2;$('#table').bootstrapTable("destroy");var $querybtn=$("#querybtn").button("loading");$("#resetbtn").attr("disabled",true);$table=$('#table').bootstrapTable({height:getTableHeight(),url:cxt+"/datainterface/getdata/bootstarptable/"+dataset.name,method:'POST',striped:true,cache:false,pagination:true,smartDisplay:false,sortable:false,sortOrder:"asc",paginationLoop:false,undefinedText:'',contentType:"application/json",queryParamsType:"undefined",queryParams:function queryParams(param){var data={page:param.pageNumber,rows:param.pageSize,order:param.sortOrder,searchText:param.searchText==undefined?'':param.searchText};var obj=$.extend(data,querycondition);return JSON.stringify(obj)},sidePagination:"server",pageNumber:1,pageSize:30,pageList:[30,50,100,'全部'],search:false,clickToSelect:false,columns:initColumnmeta(dataset.metadata),onClickCell:function(field,value,row,$cell){var clickcell=dataset.clickcell;if(clickcell!=undefined&&clickcell!=""){eval(clickcell)}},onPageChange:function(number,size){tableMarge();onPageChangeMap()},onLoadSuccess:function(data){$querybtn.button("reset");$("#resetbtn").attr("disabled",false);if(type=='listmap'||type=='maplist'){}tableMarge();onPageChangeMap();},onClickRow:function(row,$row,cell){$table.bootstrapTable('uncheckAll');$table.bootstrapTable('check',$row.attr("data-index"));if(mapOption.poilight&&mapOption.poilight==true){lightMapLayer(row)}if(mapOption.popup&&mapOption.popup==true){popupAnim(row)}if(mapOption.click&&mapOption.click==true){map.getView().setCenter([Number(row.X),Number(row.Y)]);map.getView().setZoom(22)}if(mapOption.globalheight&&mapOption.globalheight["show"]==true){globalHeight(mapOption.globalheight,row)}}})}function onPageChangeMap(){var rows=$('#table').bootstrapTable("getData");mapOption.linstring["params"]["rows"]=[];for(var i=0;i<rows.length;i+=1){mapOption.linstring["params"]["rows"].push($('#table').bootstrapTable("getData")[i])}if(mapOption.linstring&&mapOption.linstring.show==true){lineString(mapOption.linstring)}}